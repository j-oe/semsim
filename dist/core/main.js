define(["modules/tokens","modules/sets","modules/vectors","modules/matrix","configs/config-core"],function(e,n,t,r,a){return this.fc={version:"1.0.0",train:function(e,n){var t={returnMatrix:!0,returnObj:!1,defaultClass:!1,timeElapsed:!0,extendObj:{}},a=Object.assign({},t,n),i=fc.prepare(e,a.extendObj,a.defaultClass);return a.returnMatrix&&!a.returnObj?r.create(i,e):a.returnMatrix&&a.returnObj?[r.create(i,e),i]:!a.returnMatrix&&a.returnObj?i:[]},extend:function(e,n){return fc.train(e,{extendObj:n,returnObj:!0})},prepare:function(t,r,i){for(var s=r||{},f=0,o=[],u=0,g=0;g<t.length;g++){var c=i||t[g].clf,l=e.ngram(t[g].txt,a.nrOfNgrams,a.minLengthOfTokens),m=[];a.signalsEnabled&&t[g].hasOwnProperty("sig")&&(m=e.ngram(t[g].sig,a.nrOfNgrams,a.minLengthOfTokens)),l.length>1+a.minNrOfTokens&&(s.hasOwnProperty(c)||(s[c]={}),e.update(s[c],l,m,a.tokenWeighting,a.signalWeighting),f++,o.push(e.seperate(t[g].txt,a.minLengthOfTokens).length))}return o=o.filter(function(e){return e>0}),u=Math.round(10*n.avg(o))/10,s["@cls"]=Object.keys(s).length,s["@avg"]=u,s["@inp"]=t.length,s["@cnt"]=f,s},classify:function(n,r){for(var i=fc._getTime(),s=e.ngram(n,a.nrOfNgrams,a.minLengthOfTokens,a.encryptTokens),f=t.create(e.count(s),r[0]),o=[null],u=1;u<r.length;u++){var g=r[u].slice(1),c=t[a.similarityCalc](f,g);o.push(c)}for(var l=fc._getClass(o,r),m=fc._getConf(o),h=fc._getTime(),O=h-i,d=[],p=o.length-1;p>=0;p--)null!==o[p]&&d.push({lbl:r[p][0],val:o[p]});return{pred:l,conf:Math.round(m),time:Math.round(O),info:d}},_getClass:function(e,t){var r=e.indexOf(n.max(e));return t[r]?t[r][0]:"CLASSIFICATION_ERROR"},_getConf:function(e){var t=n.srt(e);return(t[0]-t[1])/(t[0]-t[t.length-1])*100||0},_getTime:function(){return"undefined"!=typeof performance?performance.now():Date.now()}},this.fc});