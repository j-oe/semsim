!function(){!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("localforage",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.localforage=e()}}(function(){return function e(t,n,r){function o(a,l){if(!n[a]){if(!t[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return o(n||e)},u,u.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){(function(e){"use strict";function n(){u=!0;for(var e,t,n=f.length;n;){for(t=f,f=[],e=-1;++e<n;)t[e]();n=f.length}u=!1}function r(e){1!==f.push(e)||u||o()}var o,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var a=0,l=new i(n),s=e.document.createTextNode("");l.observe(s,{characterData:!0}),o=function(){s.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)o="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){n(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(n,0)};else{var c=new e.MessageChannel;c.port1.onmessage=n,o=function(){c.port2.postMessage(0)}}var u,f=[];t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";function r(){}function o(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=y,this.queue=[],this.outcome=void 0,e!==r&&s(this,e)}function i(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function a(e,t,n){m(function(){var r;try{r=t(n)}catch(t){return h.reject(e,t)}r===e?h.reject(e,new TypeError("Cannot resolve promise with itself")):h.resolve(e,r)})}function l(e){var t=e&&e.then;if(e&&"object"==typeof e&&"function"==typeof t)return function(){t.apply(e,arguments)}}function s(e,t){function n(t){i||(i=!0,h.reject(e,t))}function r(t){i||(i=!0,h.resolve(e,t))}function o(){t(r,n)}var i=!1,a=c(o);"error"===a.status&&n(a.value)}function c(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}function u(e){return e instanceof this?e:h.resolve(new this(r),e)}function f(e){var t=new this(r);return h.reject(t,e)}function d(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,o=!1;if(!n)return this.resolve([]);for(var i=new Array(n),a=0,l=-1,s=new this(r);++l<n;)!function(e,r){function l(e){i[r]=e,++a!==n||o||(o=!0,h.resolve(s,i))}t.resolve(e).then(l,function(e){o||(o=!0,h.reject(s,e))})}(e[l],l);return s}function p(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,o=!1;if(!n)return this.resolve([]);for(var i=-1,a=new this(r);++i<n;)!function(e){t.resolve(e).then(function(e){o||(o=!0,h.resolve(a,e))},function(e){o||(o=!0,h.reject(a,e))})}(e[i]);return a}var m=e(1),h={},g=["REJECTED"],v=["FULFILLED"],y=["PENDING"];t.exports=n=o,o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){if("function"!=typeof e&&this.state===v||"function"!=typeof t&&this.state===g)return this;var n=new this.constructor(r);if(this.state!==y){a(n,this.state===v?e:t,this.outcome)}else this.queue.push(new i(n,e,t));return n},i.prototype.callFulfilled=function(e){h.resolve(this.promise,e)},i.prototype.otherCallFulfilled=function(e){a(this.promise,this.onFulfilled,e)},i.prototype.callRejected=function(e){h.reject(this.promise,e)},i.prototype.otherCallRejected=function(e){a(this.promise,this.onRejected,e)},h.resolve=function(e,t){var n=c(l,t);if("error"===n.status)return h.reject(e,n.value);var r=n.value;if(r)s(e,r);else{e.state=v,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},h.reject=function(e,t){e.state=g,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},n.resolve=u,n.reject=f,n.all=d,n.race=p},{1:1}],3:[function(e,t,n){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(i){if("TypeError"!==i.name)throw i;for(var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,r=new n,o=0;o<e.length;o+=1)r.append(e[o]);return r.getBlob(t.type)}}function i(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function a(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function l(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function s(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}function c(e){return new ue(function(t){var n=e.transaction(fe,me),r=o([""]);n.objectStore(fe).put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}}).catch(function(){return!1})}function u(e){return"boolean"==typeof se?ue.resolve(se):c(e).then(function(e){return se=e})}function f(e){var t=ce[e.name],n={};n.promise=new ue(function(e){n.resolve=e}),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then(function(){return n.promise}):t.dbReady=n.promise}function d(e){var t=ce[e.name],n=t.deferredOperations.pop();n&&n.resolve()}function p(e,t){var n=ce[e.name],r=n.deferredOperations.pop();r&&r.reject(t)}function m(e,t){return new ue(function(n,r){if(e.db){if(!t)return n(e.db);f(e),e.db.close()}var o=[e.name];t&&o.push(e.version);var i=le.open.apply(le,o);t&&(i.onupgradeneeded=function(t){var n=i.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(fe)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),i.onerror=function(e){e.preventDefault(),r(i.error)},i.onsuccess=function(){n(i.result),d(e)}})}function h(e){return m(e,!1)}function g(e){return m(e,!0)}function v(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,o=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||n){if(n){var i=e.db.version+1;i>e.version&&(e.version=i)}return!0}return!1}function y(e){return new ue(function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)})}function b(e){return o([s(atob(e.data))],{type:e.type})}function _(e){return e&&e.__local_forage_encoded_blob}function w(e){var t=this,n=t._initReady().then(function(){var e=ce[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return a(n,e,e),n}function x(e){f(e);for(var t=ce[e.name],n=t.forages,r=0;r<n.length;r++)n[r]._dbInfo.db&&(n[r]._dbInfo.db.close(),n[r]._dbInfo.db=null);return m(e,!1).then(function(e){for(var t=0;t<n.length;t++)n[t]._dbInfo.db=e}).catch(function(t){throw p(e,t),t})}function S(e,t,n){try{var r=e.db.transaction(e.storeName,t);n(null,r)}catch(r){if(!e.db||"InvalidStateError"===r.name)return x(e).then(function(){var r=e.db.transaction(e.storeName,t);n(null,r)});n(r)}}function M(e){function t(){return ue.resolve()}var n=this,r={db:null};if(e)for(var o in e)r[o]=e[o];ce||(ce={});var i=ce[r.name];i||(i={forages:[],db:null,dbReady:null,deferredOperations:[]},ce[r.name]=i),i.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=w);for(var a=[],l=0;l<i.forages.length;l++){var s=i.forages[l];s!==n&&a.push(s._initReady().catch(t))}var c=i.forages.slice(0);return ue.all(a).then(function(){return r.db=i.db,h(r)}).then(function(e){return r.db=e,v(r,n._defaultConfig.version)?g(r):e}).then(function(e){r.db=i.db=e,n._dbInfo=r;for(var t=0;t<c.length;t++){var o=c[t];o!==n&&(o._dbInfo.db=r.db,o._dbInfo.version=r.version)}})}function I(e,t){var n=this;e=l(e);var r=new ue(function(t,r){n.ready().then(function(){S(n._dbInfo,pe,function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName),l=a.get(e);l.onsuccess=function(){var e=l.result;void 0===e&&(e=null),_(e)&&(e=b(e)),t(e)},l.onerror=function(){r(l.error)}}catch(e){r(e)}})}).catch(r)});return i(r,t),r}function k(e,t){var n=this,r=new ue(function(t,r){n.ready().then(function(){S(n._dbInfo,pe,function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName),l=a.openCursor(),s=1;l.onsuccess=function(){var n=l.result;if(n){var r=n.value;_(r)&&(r=b(r));var o=e(r,n.key,s++);void 0!==o?t(o):n.continue()}else t()},l.onerror=function(){r(l.error)}}catch(e){r(e)}})}).catch(r)});return i(r,t),r}function E(e,t,n){var r=this;e=l(e);var o=new ue(function(n,o){var i;r.ready().then(function(){return i=r._dbInfo,"[object Blob]"===de.call(t)?u(i.db).then(function(e){return e?t:y(t)}):t}).then(function(t){S(r._dbInfo,me,function(i,a){if(i)return o(i);try{var l=a.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var s=l.put(t,e);a.oncomplete=function(){void 0===t&&(t=null),n(t)},a.onabort=a.onerror=function(){var e=s.error?s.error:s.transaction.error;o(e)}}catch(e){o(e)}})}).catch(o)});return i(o,n),o}function D(e,t){var n=this;e=l(e);var r=new ue(function(t,r){n.ready().then(function(){S(n._dbInfo,me,function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName),l=a.delete(e);i.oncomplete=function(){t()},i.onerror=function(){r(l.error)},i.onabort=function(){var e=l.error?l.error:l.transaction.error;r(e)}}catch(e){r(e)}})}).catch(r)});return i(r,t),r}function A(e){var t=this,n=new ue(function(e,n){t.ready().then(function(){S(t._dbInfo,me,function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName),a=i.clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=a.error?a.error:a.transaction.error;n(e)}}catch(e){n(e)}})}).catch(n)});return i(n,e),n}function O(e){var t=this,n=new ue(function(e,n){t.ready().then(function(){S(t._dbInfo,pe,function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName),a=i.count();a.onsuccess=function(){e(a.result)},a.onerror=function(){n(a.error)}}catch(e){n(e)}})}).catch(n)});return i(n,e),n}function C(e,t){var n=this,r=new ue(function(t,r){if(e<0)return void t(null);n.ready().then(function(){S(n._dbInfo,pe,function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName),l=!1,s=a.openCursor();s.onsuccess=function(){var n=s.result;if(!n)return void t(null);0===e?t(n.key):l?t(n.key):(l=!0,n.advance(e))},s.onerror=function(){r(s.error)}}catch(e){r(e)}})}).catch(r)});return i(r,t),r}function L(e){var t=this,n=new ue(function(e,n){t.ready().then(function(){S(t._dbInfo,pe,function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName),a=i.openCursor(),l=[];a.onsuccess=function(){var t=a.result;if(!t)return void e(l);l.push(t.key),t.continue()},a.onerror=function(){n(a.error)}}catch(e){n(e)}})}).catch(n)});return i(n,e),n}function j(e){var t,n,r,o,i,a=.75*e.length,l=e.length,s=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var c=new ArrayBuffer(a),u=new Uint8Array(c);for(t=0;t<l;t+=4)n=ge.indexOf(e[t]),r=ge.indexOf(e[t+1]),o=ge.indexOf(e[t+2]),i=ge.indexOf(e[t+3]),u[s++]=n<<2|r>>4,u[s++]=(15&r)<<4|o>>2,u[s++]=(3&o)<<6|63&i;return c}function R(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=ge[n[t]>>2],r+=ge[(3&n[t])<<4|n[t+1]>>4],r+=ge[(15&n[t+1])<<2|n[t+2]>>6],r+=ge[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}function N(e,t){var n="";if(e&&(n=je.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===je.call(e.buffer))){var r,o=be;e instanceof ArrayBuffer?(r=e,o+=we):(r=e.buffer,"[object Int8Array]"===n?o+=Se:"[object Uint8Array]"===n?o+=Me:"[object Uint8ClampedArray]"===n?o+=Ie:"[object Int16Array]"===n?o+=ke:"[object Uint16Array]"===n?o+=De:"[object Int32Array]"===n?o+=Ee:"[object Uint32Array]"===n?o+=Ae:"[object Float32Array]"===n?o+=Oe:"[object Float64Array]"===n?o+=Ce:t(new Error("Failed to get type for BinaryArray"))),t(o+R(r))}else if("[object Blob]"===n){var i=new FileReader;i.onload=function(){var n=ve+e.type+"~"+R(this.result);t(be+xe+n)},i.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}}function T(e){if(e.substring(0,_e)!==be)return JSON.parse(e);var t,n=e.substring(Le),r=e.substring(_e,Le);if(r===xe&&ye.test(n)){var i=n.match(ye);t=i[1],n=n.substring(i[0].length)}var a=j(n);switch(r){case we:return a;case xe:return o([a],{type:t});case Se:return new Int8Array(a);case Me:return new Uint8Array(a);case Ie:return new Uint8ClampedArray(a);case ke:return new Int16Array(a);case De:return new Uint16Array(a);case Ee:return new Int32Array(a);case Ae:return new Uint32Array(a);case Oe:return new Float32Array(a);case Ce:return new Float64Array(a);default:throw new Error("Unkown type: "+r)}}function P(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var o=new ue(function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction(function(o){o.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){t._dbInfo=n,e()},function(e,t){r(t)})})});return n.serializer=Re,o}function B(e,t){var n=this;e=l(e);var r=new ue(function(t,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=o.serializer.deserialize(r)),t(r)},function(e,t){r(t)})})}).catch(r)});return i(r,t),r}function F(e,t){var n=this,r=new ue(function(t,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT * FROM "+o.storeName,[],function(n,r){for(var i=r.rows,a=i.length,l=0;l<a;l++){var s=i.item(l),c=s.value;if(c&&(c=o.serializer.deserialize(c)),void 0!==(c=e(c,s.key,l+1)))return void t(c)}t()},function(e,t){r(t)})})}).catch(r)});return i(r,t),r}function z(e,t,n,r){var o=this;e=l(e);var a=new ue(function(i,a){o.ready().then(function(){void 0===t&&(t=null);var l=t,s=o._dbInfo;s.serializer.serialize(t,function(t,c){c?a(c):s.db.transaction(function(n){n.executeSql("INSERT OR REPLACE INTO "+s.storeName+" (key, value) VALUES (?, ?)",[e,t],function(){i(l)},function(e,t){a(t)})},function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void i(z.apply(o,[e,l,n,r-1]));a(t)}})})}).catch(a)});return i(a,n),a}function q(e,t,n){return z.apply(this,[e,t,n,1])}function U(e,t){var n=this;e=l(e);var r=new ue(function(t,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("DELETE FROM "+o.storeName+" WHERE key = ?",[e],function(){t()},function(e,t){r(t)})})}).catch(r)});return i(r,t),r}function W(e){var t=this,n=new ue(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("DELETE FROM "+r.storeName,[],function(){e()},function(e,t){n(t)})})}).catch(n)});return i(n,e),n}function V(e){var t=this,n=new ue(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("SELECT COUNT(key) as c FROM "+r.storeName,[],function(t,n){var r=n.rows.item(0).c;e(r)},function(e,t){n(t)})})}).catch(n)});return i(n,e),n}function X(e,t){var n=this,r=new ue(function(t,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)},function(e,t){r(t)})})}).catch(r)});return i(r,t),r}function J(e){var t=this,n=new ue(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("SELECT key FROM "+r.storeName,[],function(t,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).key);e(r)},function(e,t){n(t)})})}).catch(n)});return i(n,e),n}function $(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(e){return!0}}function G(){return!$()||localStorage.length>0}function H(e){var t=this,n={};if(e)for(var r in e)n[r]=e[r];return n.keyPrefix=n.name+"/",n.storeName!==t._defaultConfig.storeName&&(n.keyPrefix+=n.storeName+"/"),G()?(t._dbInfo=n,n.serializer=Re,ue.resolve()):ue.reject()}function K(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}});return i(n,e),n}function Q(e,t){var n=this;e=l(e);var r=n.ready().then(function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r});return i(r,t),r}function Y(e,t){var n=this,r=n.ready().then(function(){for(var t=n._dbInfo,r=t.keyPrefix,o=r.length,i=localStorage.length,a=1,l=0;l<i;l++){var s=localStorage.key(l);if(0===s.indexOf(r)){var c=localStorage.getItem(s);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,s.substring(o),a++)))return c}}});return i(r,t),r}function Z(e,t){var n=this,r=n.ready().then(function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t});return i(r,t),r}function ee(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo,n=localStorage.length,r=[],o=0;o<n;o++){var i=localStorage.key(o);0===i.indexOf(e.keyPrefix)&&r.push(i.substring(e.keyPrefix.length))}return r});return i(n,e),n}function te(e){var t=this,n=t.keys().then(function(e){return e.length});return i(n,e),n}function ne(e,t){var n=this;e=l(e);var r=n.ready().then(function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return i(r,t),r}function re(e,t,n){var r=this;e=l(e);var o=r.ready().then(function(){void 0===t&&(t=null);var n=t;return new ue(function(o,i){var a=r._dbInfo;a.serializer.serialize(t,function(t,r){if(r)i(r);else try{localStorage.setItem(a.keyPrefix+e,t),o(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||i(e),i(e)}})})});return i(o,n),o}function oe(e,t){e[t]=function(){var n=arguments;return e.ready().then(function(){return e[t].apply(e,n)})}}function ie(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(Pe(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},le=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();"undefined"==typeof Promise&&e(3);var se,ce,ue=Promise,fe="local-forage-detect-blob-support",de=Object.prototype.toString,pe="readonly",me="readwrite",he={_driver:"asyncStorage",_initStorage:M,_support:function(){try{if(!le)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:k,getItem:I,setItem:E,removeItem:D,clear:A,length:O,key:C,keys:L},ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ve="~~local_forage_type~",ye=/^~~local_forage_type~([^~]+)~/,be="__lfsc__:",_e=be.length,we="arbf",xe="blob",Se="si08",Me="ui08",Ie="uic8",ke="si16",Ee="si32",De="ur16",Ae="ui32",Oe="fl32",Ce="fl64",Le=_e+we.length,je=Object.prototype.toString,Re={serialize:N,deserialize:T,stringToBuffer:j,bufferToString:R},Ne={_driver:"webSQLStorage",_initStorage:P,_support:function(){return"function"==typeof openDatabase}(),iterate:F,getItem:B,setItem:q,removeItem:U,clear:W,length:V,key:X,keys:J},Te={_driver:"localStorageWrapper",_initStorage:H,_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&"function"==typeof localStorage.setItem}catch(e){return!1}}(),iterate:Y,getItem:Q,setItem:re,removeItem:ne,clear:K,length:te,key:Z,keys:ee},Pe=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Be={},Fe={},ze={INDEXEDDB:he,WEBSQL:Ne,LOCALSTORAGE:Te},qe=[ze.INDEXEDDB._driver,ze.WEBSQL._driver,ze.LOCALSTORAGE._driver],Ue=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],We={description:"",driver:qe.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},Ve=function(){function e(t){r(this,e);for(var n in ze)if(ze.hasOwnProperty(n)){var o=ze[n],i=o._driver;this[n]=i,Be[i]||this.defineDriver(o)}this._defaultConfig=ie({},We),this._config=ie({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":ae(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e&&e.driver)||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new ue(function(t,n){try{var r=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(o);for(var i=Ue.concat("_initStorage"),a=0,l=i.length;a<l;a++){var s=i[a];if(!s||!e[s]||"function"!=typeof e[s])return void n(o)}var c=function(n){Be[r]&&console.info("Redefining LocalForage driver: "+r),Be[r]=e,Fe[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(c,n):c(!!e._support):c(!0)}catch(e){n(e)}});return a(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=Be[e]?ue.resolve(Be[e]):ue.reject(new Error("Driver not found."));return a(r,t,n),r},e.prototype.getSerializer=function(e){var t=ue.resolve(Re);return a(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return a(n,e,e),n},e.prototype.setDriver=function(e,t,n){function r(){l._config.driver=l.driver()}function o(e){return l._extend(e),r(),l._ready=l._initStorage(l._config),l._ready}function i(e){return function(){function t(){for(;n<e.length;){var i=e[n];return n++,l._dbInfo=null,l._ready=null,l.getDriver(i).then(o).catch(t)}r();var a=new Error("No available storage method found.");return l._driverSet=ue.reject(a),l._driverSet}var n=0;return t()}}var l=this;Pe(e)||(e=[e]);var s=this._getSupportedDrivers(e),c=null!==this._driverSet?this._driverSet.catch(function(){return ue.resolve()}):ue.resolve();return this._driverSet=c.then(function(){var e=s[0];return l._dbInfo=null,l._ready=null,l.getDriver(e).then(function(e){l._driver=e._driver,r(),l._wrapLibraryMethodsWithReady(),l._initDriver=i(s)})}).catch(function(){r();var e=new Error("No available storage method found.");return l._driverSet=ue.reject(e),l._driverSet}),a(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!Fe[e]},e.prototype._extend=function(e){ie(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n];this.supports(o)&&t.push(o)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=Ue.length;e<t;e++)oe(this,Ue[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),Xe=new Ve;t.exports=Xe},{3:3}]},{},[4])(4)}),define("controller/local",["localforage"],function(e){var t={idx:"fc_index",key:"fc_license",set:"fc_settings",init:function(){var n=localStorage.getItem(t.idx),r=localStorage.getItem(t.set);null===n&&localStorage.setItem(t.idx,"[]"),null!==r&&t.loadSettings(),e.config({name:"fastclass"})},getKey:function(){return localStorage.getItem(t.idx)},clear:function(){return localStorage.clear(),e.clear()},getModels:function(){return t._getIndex().filter(function(e){return"model"===e.type})},getReports:function(){return t._getIndex().filter(function(e){return"report"===e.type})},storeModel:function(n){var r=n.meta.modelID,o=n.meta.modelName;return t._addModelToIndex(r,o,"model"),e.setItem(r,n)},storeReport:function(n){var r=n.meta.reportID,o=n.meta.reportName;return t._addModelToIndex(r,o,"report"),e.setItem(r,n)},loadModel:function(t){return e.getItem(t)},deleteModel:function(n){return t._removeModelFromIndex(n),e.removeItem(n)},saveSettings:function(e){localStorage.setItem(t.set,JSON.stringify(e))},loadSettings:function(){return localStorage.getItem(t.set)},resetSettings:function(){localStorage.removeItem(t.set)},_getIndex:function(e){return JSON.parse(localStorage.getItem(t.idx))},_updateIndex:function(e){localStorage.setItem(t.idx,JSON.stringify(e))},_addModelToIndex:function(e,n,r){var o=t._getIndex();o.push({id:e,name:n,type:r}),t._updateIndex(o)},_removeModelFromIndex:function(e){var n=t._getIndex(),r=n.map(function(e){return e.id}).indexOf(e);n.splice(r,1),t._updateIndex(n)}};return t}),define("config/params",["controller/local"],function(e){var t={nrOfNgrams:{label:"Word groups",value:void 0,defaultValue:-2,writable:!0,type:"list",values:[{text:"n = {1,2,3}",value:-3},{text:"n = {1,2}",value:-2},{text:"n = 1",value:1},{text:"n = 2",value:2},{text:"n = 3",value:3},{text:"n = 4",value:4}]},similarityCalc:{label:"Similarity measurement",value:void 0,defaultValue:"cosine",writable:!1,type:"list",values:[{text:"Kosinus",value:"cosine"},{text:"L1 / Manhattan",value:"l1"},{text:"Testmaß",value:"custom"}]},normalizeWeights:{label:"Normalization",value:void 0,defaultValue:!0,writable:!1,type:"boolean"},minNrOfTokens:{label:"Minimum number of tokens",value:void 0,defaultValue:1,writable:!0,type:"range",values:{min:0,max:5,step:1}},minLengthOfTokens:{label:"Minimum token character length",value:void 0,defaultValue:0,writable:!0,type:"range",values:{min:0,max:10,step:1}},tokenWeighting:{label:"Token weighting",value:void 0,defaultValue:1,writable:!1,type:"range",values:{min:1,max:100,step:.5}},signalsEnabled:{label:"Semantic weighting",value:void 0,defaultValue:!1,writable:!0,type:"boolean"},signalWeighting:{label:"Weighting quantifier",value:void 0,defaultValue:10,writable:!0,type:"range",values:{min:1,max:100,step:.5}},similarityThreshold:{label:"Similarity threshold",value:void 0,defaultValue:90,writable:!0,type:"range",values:{min:0,max:100,step:.5}},verboseReporting:{label:"Verbose reporting",value:void 0,defaultValue:!1,writable:!1,type:"boolean"},appIRI:{label:"Identifier der Anwendung",value:"http://dev.fastclass.de",writable:!1,type:"string"},appName:{label:"Name der Anwendung",value:"fastclass DevPreview",writable:!1,type:"string"},smWorkerURL:{value:"scripts/worker/similarities-worker.js",writable:!1,type:"string"},dfWorkerURL:{value:"scripts/worker/diffing-worker.js",writable:!1,type:"string"},demoFiles:{value:{fcr:{en:"res/data/example.fcr"}},writable:!1}},n={setParam:function(r,o,i){t.hasOwnProperty(r)?t[r].writable&&(t[r].value=o,i||e.saveSettings(n.getConfig())):console.log("tried to set unknown param: ",r)},getParam:function(e){if(t.hasOwnProperty(e))return void 0===t[e].value?t[e].defaultValue:t[e].value;console.log("tried to get unknown param: ",e)},getCompleteConfig:function(e){return t},getWritableConfig:function(e){var n={};return Object.keys(t).forEach(function(e){t[e].writable&&(n[e]=t[e])}),n},getConfig:function(){var e={};return Object.keys(t).forEach(function(t){e[t]=n.getParam(t)}),e},loadConfig:function(e){Object.keys(e).forEach(function(t){n.setParam(t,e[t],!0)})},resetConfig:function(){Object.keys(t).forEach(function(e){n.setParam(e,t[e].defaultValue,!0)})}};return n}),define("helper/util",[],function(){var e={browserHasFunctionality:function(){var e=window.Worker&&window.File&&window.FileReader&&window.DOMParser&&window.fetch&&Object.keys&&Object.assign,t=/Trident/i.test(navigator.userAgent);return e&&!t},stripURL:function(e){return e&&-1!==e.indexOf("#")?e.substring(e.indexOf("#")+1):"start"},makeUnique:function(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=!0;return Object.keys(t)},pushArray:function(e,t){return Array.prototype.push.apply(e,t),e},indexOfMax:function(e){for(var t=e[0],n=0,r=1;r<e.length;r++)e[r]>t&&(n=r,t=e[r]);return n},getClassDistribution:function(e){var t=[];if(e.constructor===Object)for(var n in e)"@"!==n.substring(0,1)&&t.push({label:n,value:e[n]["@total"]});else{for(var r={},o=0;o<e.length;o++)r[e[o].clf]=r[e[o].clf]+1||1;for(var i in r)t.push({label:i,value:r[i]})}return t},copyObject:function(e){return JSON.parse(JSON.stringify(e))},createFileName:function(e){return"fastclass_"+e.replace(/\s+/g,"-").replace(/[@,\.;:\?!\\§$%&#\/\(\)=\+±`'‚’„“”"\*´°><^\[\]]+/g,"")},requireCSS:function(e){if(!1===Array.prototype.slice.call(document.getElementsByTagName("link")).some(function(t){return t.attributes.href.value===e})){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}},downloadFile:function(t,n,r){var o=r?t:JSON.stringify(t),i=new Blob([o],{type:"octet/stream"});e.downloadBlob(i,n)},downloadBlob:function(e,t){var n=window.URL.createObjectURL(e),r=document.createElement("a");r.download=t,r.href=n,r.click(),r.remove(),window.URL.revokeObjectURL(n)},getUUID:function(e){var t=(new Date).getTime();return(e||"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx").replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)})},hashString:function(e){var t,n,r=0;if(0===this.length)return r;for(t=0;t<this.length;t++)n=this.charCodeAt(t),r=(r<<5)-r+n,r|=0;return r},findOverlap:function(t,n){return 0===n.length?"":t.endsWith(n)?n:t.indexOf(n)>=0?n:e.findOverlap(t,n.substring(0,n.length-1))},getSlug:function(e){e=e.replace(/^\s+|\s+$/g,""),e=e.toLowerCase();for(var t="àáäâèéëêìíïîòóöôùúüûñç·/_,:;",n="aaaaeeeeiiiioooouuuunc------",r=0,o=t.length;r<o;r++)e=e.replace(new RegExp(t.charAt(r),"g"),n.charAt(r));return e=e.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")},getLocale:function(){return document.documentElement.lang},getTime:function(){return performance?performance.now():Date.now()},getDateString:function(){return(new Date).toISOString()},round:function(e,t){var n=t||0;return Math.round(e*Math.pow(10,n))/Math.pow(10,n)},percent:function(t,n,r){if(t&&n&&0!==n)return e.round(t/n*100,r)+"%"
}};return e});var e=document.documentElement.lang||"de";define("helper/l10n",["../../res/lang/"+e],function(e){return function(t){return e.hasOwnProperty(t)?e[t]:(console.log("Missing l10n key: ",t),"MISSING STRING DEFINITION")}}),define("view/ui",["helper/l10n","helper/util"],function(e,t){var n={e:function(e){return""!==e&&void 0!==e?document.getElementById(e):null},q:function(e){var t=document.querySelectorAll(e);return Array.prototype.slice.call(t)},qA:function(e){return document.querySelectorAll(e)},show:function(e,t){Array.isArray(e)?e.forEach(function(e){n.show(e,t)}):"none"===n.e(e).style.display&&(n.e(e).style.display=t||"block")},hide:function(e){if(Array.isArray(e))e.forEach(function(e){n.hide(e)});else{n.e(e)&&"none"!==n.e(e).style.display&&(n.e(e).style.display="none")}},loading:function(e,t){Array.isArray(e)?e.forEach(function(e){n.loading(e,t)}):e&&(void 0===t&&n.e(e).classList.toggle("loading"),!0===t&&n.e(e).classList.add("loading"),!1===t&&n.e(e).classList.remove("loading"))},create:function(e){return document.createElement(e)},append:function(e,t){Array.isArray(t)?t.forEach(function(t){n.append(e,t)}):t&&e.appendChild(t)},content:function(e,t){if(e===Object(e))for(var r in e)n.content(r,e[r]);else n.e(e).innerHTML=t},empty:function(e){if(Array.isArray(e))e.forEach(function(e){n.empty(e)});else{var t=n.e(e);if(t.firstChild)for(;t.firstChild;)t.removeChild(t.firstChild)}},bind:function(e,t,r){n.e(e)&&n.e(e).addEventListener(t,r)},click:function(e,t){Array.isArray(e)?e.forEach(function(e){n.click(e,t)}):n.bind(e,"click",function(r){n.loading(e),t(r)})},change:function(e,t){n.bind(e,"change",t)},showModal:function(t,r,o){var i=r||e("modal_title_error");n.content({"modal-title":i,"modal-content":t}),n.e("modal").classList.add("active")},closeModal:function(e){n.loading(["modal-ok","modal-x"],!1),n.e("modal").classList.remove("active")},unlockPanels:function(){n.hide(["panel_quality_warning","panel_classify_warning","panel_authoring_warning"]),n.show(["classificationData","qsOptions","classificationTextInput"]),n.q(".dropdown .disabled").forEach(function(e){e.classList.remove("disabled")})},showPanel:function(e){n.q("section").forEach(function(e){n.hide(e.id)}),e&&n.show("panel_"+e)}};return n}),define("controller/store",{modelTemplate:{conf:{},meta:{},data:{matrix:[],object:{}}},currentModel:{},model:{conf:{},meta:{},data:{matrix:[],object:{}}},report:{meta:{}},xmlDocuments:[],xmlDocumentsCl:[],xmlParsingOptions:[],pdfArrayBuffer:{},pdfBulkFiles:[],inputData:[],inputDataCl:[],inputDataRp:[],classifiedData:[],classifiedFileSources:[],classifiedFileCurrentType:void 0,repProblematicModules:[],repSimilarModules:{conf:{},meta:{},data:{results:[],mapping:{},sources:[]}},repAnnotations:[]}),define("view/bind",["config/params","view/ui","controller/store","controller/local","helper/util","helper/l10n"],function(e,t,n,r,o,i){var a={showDiffModal:function(){t.e("diff-modal").classList.add("active"),t.click(["diff-modal-x","diff-modal-overlay","diff-modal-cancel"],function(e){t.loading(e.target.id,!1),t.e("diff-modal").classList.remove("active")})},showLoadModal:function(e){function n(e){t.q("#load-modal .tab-item a").forEach(function(e){e.classList.remove("active"),t.hide("load-"+e.id)}),t.e(e).classList.add("active"),t.show("load-"+e,"flex")}t.e("load-modal").classList.add("active"),t.show("no-local-models"),t.hide("load_localModel"),t.click(["load-modal-x","load-modal-overlay"],function(e){t.loading(e.target.id,!1),t.e("load-modal").classList.remove("active")}),e&&e.length>0?(a.showLocalModels(e),n("from-browser")):n("from-filesystem"),t.q("#load-modal .tab-item").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),n(e.target.id)})})},showSettingsModal:function(){var n=e.getWritableConfig();t.empty("settings"),Object.keys(n).forEach(function(r){var i=n[r],a=t.create("tr"),l=t.create("th"),s=t.create("td");switch(l.innerText=i.label,t.append(a,[l,s]),i.type){case"list":var c=t.create("select");c.id="setting-"+r,t.append(s,c),t.append(t.e("settings"),a),o.requireCSS("vendor/selectize.css"),require(["selectize"],function(t){$("#setting-"+r).selectize({items:[e.getParam(r)],options:i.values,maxItems:1,onChange:function(t){e.setParam(r,t)}})});break;case"range":var u=t.create("input");u.id="setting-"+r,u.type="range",u.value=e.getParam(r),u.min=i.values.min,u.max=i.values.max,u.step=i.values.step,u.classList.add("slider"),u.classList.add("tooltip"),u.dataset.tooltip=e.getParam(r),t.append(s,u),t.append(t.e("settings"),a),t.bind("setting-"+r,"input",function(t){var n=t.target.value;u.dataset.tooltip=n,e.setParam(r,parseFloat(n))});break;case"boolean":var f=t.create("label"),d=t.create("input"),p=t.create("i");f.classList.add("form-switch"),p.classList.add("form-icon"),d.type="checkbox",d.checked=e.getParam(r),d.id="setting-"+r;var m=e.getParam(r)?"aktiv":"inaktiv",h=t.create("span");h.innerText=m,t.append(f,[d,p,h]),t.append(s,f),t.append(t.e("settings"),a),t.bind("setting-"+r,"change",function(t){var n=t.target.checked;h.innerText=n?"aktiv":"inaktiv",e.setParam(r,n)});break;case"string":var g=t.create("input");g.classList.add("form-input"),g.type="text",g.value=e.getParam(r),g.id="setting-"+r,t.append(s,g),t.append(t.e("settings"),a),t.bind("setting-"+r,"blur",function(t){var n=t.target.value;e.setParam(r,n)});break;default:console.log("skipping complex object")}t.e("set-modal").classList.add("active"),t.loading("change_set"),t.click(["set-modal-x","set-modal-overlay"],function(e){t.loading(e.target.id,!1),t.loading("change_set",!1),t.e("set-modal").classList.remove("active")})})},showLocalModels:function(e){t.hide("no-local-models"),t.show("load_localModel"),o.requireCSS("vendor/selectize.css"),require(["selectize"],function(t){$("#localModel").selectize({options:function(e){return e.map(function(e){return{text:e.name,value:e.id}})}(e),selectOnTab:!0})})},closeModalAndContinue:function(e,n,r){r&&t.loading(r,!1),t.e(e).classList.remove("active"),n&&(window.location.hash=n,"training"===n&&t.unlockPanels())},printReportAnalysis:function(e){window.location.hash="report",t.show(["reportAnalysis","manageReport"]),t.hide(["importFile_rp","panelTitle_rp","xmlAnalysis_rp","reportSettings"]),e.meta.reportName&&(t.e("report-name").innerText=e.meta.reportName);var n=Math.round(e.meta.timeElapsed/10)/100,r=e.data.sources.length,o=r*(r-1)/2,i=e.data.results.map(function(e){return e[0]});t.content({rA_idf:e.data.results.length,rA_cnt:r,rA_com:o,rA_tme:n+"s"}),require(["view/plot"],function(t){t.histogramSimDist("rA_histogramChart",i),t.forceDirectedGraph("rA_graph",e.data.mapping),t.dataTableSimilarities("rA_table",e.data),a.enableDiffingBtns(),a.enableGroupBtns()})},enableDiffingBtns:function(){t.qA(".diff").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),a.showDiffingViewWithWorker(e.target.dataset,e.target.id)})})},enableGroupBtns:function(){t.qA(".group").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),require(["view/plot"],function(t){t.filterDataTableSimilarities("rA_table",e.target.innerText)})})})},showDiffingViewWithWorker:function(r,l){t.loading(l);var s,c,u,f,d=r.source,p=r.target;n.repSimilarModules.data.sources.forEach(function(e){e.xid===d&&(s=e.txt,u=e.dsc),e.xid===p&&(c=e.txt,f=e.dsc)});var m=new Worker(e.getParam("dfWorkerURL"));m.addEventListener("error",function(e){t.showModal(i("work_proc_pdf"))}),m.addEventListener("message",function(e){if(e.data.ready)m.postMessage(["diffData",s,c]);else{var i=e.data[0];m.terminate(),t.empty("diff-body");var d=t.e("diff-body"),p=document.createDocumentFragment(),h=0,g=0;i.forEach(function(e){var t=!(!e.added&&!e.removed),n=e.added?"text-primary":e.removed?"text":"text-secondary",r=document.createElement("span");r.classList.add(n),t&&r.classList.add("mod"),e.added&&h++,e.removed&&g++,r.appendChild(document.createTextNode(e.value)),p.appendChild(r)});var v=u,y="";u!==f&&(y="<br/>"+f),t.content({"diff-details-t":v,"diff-details-ta":y,"diff-details-a":r.source,"diff-details-b":r.target,"diff-details-v":o.percent(r.value,1,4),"diff-details-p":"+"+h,"diff-details-m":"-"+g}),t.empty("diff-details-weighted-content"),n.repSimilarModules.meta.weightedElements&&0!==n.repSimilarModules.meta.weightedElements.length?(t.show("diff-details-weighted"),n.repSimilarModules.meta.weightedElements.forEach(function(e){var n=t.create("small");n.classList.add("label","label-warning"),n.innerText=e,t.append(t.e("diff-details-weighted-content"),n)})):t.hide("diff-details-weighted"),d.appendChild(p),a.showDiffModal(),t.loading(l)}})},resetXMLoptions:function(e){var t=e?"_cl":"";o.requireCSS("vendor/selectize.css"),require(["selectize"],function(e){var n=$("#xmlAttr"+t).selectize();selectElemInstance=$("#xmlElem"+t).selectize(),n&&selectElemInstance&&(n[0].selectize.clearOptions(),selectElemInstance[0].selectize.clearOptions())})},printXMLoptions:function(n,r){var i="";"classify"===r&&(i="_cl"),"report"===r&&(i="_rp");var a=Object.keys(n).sort();o.requireCSS("vendor/selectize.css"),require(["selectize"],function(o){function l(e){return e.map(function(e){return{text:e,value:e}})}function s(){var e=[],r=[];t.q("#xmlElem"+i+" option:checked").forEach(function(t){e.push(t.value)});for(var o=0;o<e.length;o++){var a=e[o],s=Object.keys(n[a]);r=o>0?r.filter(function(e){return s.includes(e)}):r.concat(s)}return l(r.sort())}function c(){var e=s(),t=$("#xmlAttr"+i).selectize();t[0].selectize.clearOptions(),t[0].selectize.addOption(e),t[0].selectize.refreshOptions()}if(t.show("xmlAnalysis"+i),"classify"!==r){var u=e.getParam("signalsEnabled");t.show("showSignalSelection"+i),t.e("showSignalSelection"+i).checked=e.getParam("signalsEnabled"),u&&$("#signalSelection"+i).show(),t.click("showSignalSelection"+i,function(){e.setParam("signalsEnabled",t.e("showSignalSelection"+i).checked),$("#signalSelection"+i).toggle()}),$("#xmlElemSignal"+i).selectize({options:l(a)}),t.content("signalWeightValue"+i,e.getParam("signalWeighting")+"x"),t.e("signalWeight"+i).value=e.getParam("signalWeighting"),t.bind("signalWeight"+i,"input",function(n){var r=n.target.value;e.setParam("signalsEnabled",!0),e.setParam("signalWeighting",r),t.content("signalWeightValue"+i,r+"x")})}$("#xmlAttr"+i).selectize({options:[],onChange:function(e){""!==e?t.show("import_xml"+i):t.hide("import_xml"+i)}}),$("#xmlElem"+i).selectize({options:l(a),selectOnTab:!0,onChange:function(){c()}})})},getXMLoptions:function(e){var r="";"classify"===e&&(r="_cl"),"report"===e&&(r="_rp");var o=t.e("xmlAttr"+r).value,i=[],a=[];return t.q("#xmlElem"+r+" option:checked").forEach(function(e){i.push(e.value)}),"classify"!==e&&t.q("#xmlElemSignal"+r+" option:checked").forEach(function(e){a.push(e.value)}),n.xmlParsingSettings=[i,o,a],n.xmlParsingSettings}};return a}),define("controller/work",["config/params","view/ui","view/bind","controller/store","helper/util","helper/l10n"],function(e,t,n,r,o,i){return{getSimilarityReport:function(a){if(r.inputDataRp&&0!==r.inputDataRp.length){var l=new Worker(e.getParam("smWorkerURL"));l.addEventListener("error",function(e){t.showModal(i("work_proc_dupes"))}),l.addEventListener("message",function(i){i.data.ready?l.postMessage(["findSimilar",r.inputDataRp,e.getConfig()]):(r.repSimilarModules.data.sources=r.inputDataRp,r.repSimilarModules.meta.reportCreated=o.getDateString(),r.repSimilarModules.meta.timeElapsed=i.data[1],r.repSimilarModules.conf=e.getConfig(),r.repSimilarModules.data.results=i.data[0],r.repSimilarModules.data.mapping=i.data[2],"xml"===a&&(r.repSimilarModules.meta.weightedElements=r.xmlParsingSettings[2]),i.data[0].length>0?n.printReportAnalysis(r.repSimilarModules):t.showModal("Überprüfen Sie den eingestellten Grenzwert","Keine Ergebnisse"),t.loading("import_"+a+"_rp"),l.terminate())})}else t.showModal(i("work_no_userdata")),t.loading("import_"+a+"_rp")},exportConfig:function(){e.getConfig()&&(o.downloadFile(e.getConfig(),"fastclass_config"+Date.now()+".json"),t.loading("export_set"))},exportSource:function(){r.inputData&&(o.downloadFile(r.inputData,"fastclass_source"+Date.now()+".json"),t.loading("save_source"))},exportMemory:function(){r.model.data.matrix&&0!==Object.keys(r.model.data.matrix).length?require(["zip"],function(n){var i=new n;r.model.conf=e.getConfig(),i.folder("fastclass").file("model.json",JSON.stringify(r.model)),i.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}}).then(function(e){o.downloadBlob(e,o.createFileName(r.model.meta.modelName)+".fcm"),t.loading("save_fcm")})}):(t.showModal(i("work_no_model")),t.loading("save_fcm"))},exportResults:function(e){if(r.classifiedData&&0!==r.classifiedData.length){var n=[].concat(r.classifiedData);e&&n.forEach(function(e){delete e.txt}),o.downloadFile(n,"fastclass_"+Date.now()+".json"),t.loading("export_results")}else t.showModal(i("work_no_classdata")),t.loading("export_results")},exportReport:function(){if(r.repProblematicModules&&0!==r.repProblematicModules.length){var e=[].concat(r.repProblematicModules);e.forEach(function(e){delete e.txt}),o.downloadFile(e,"fastclass_problematicModules_"+Date.now()+".json")}else t.showModal(i("work_no_classdata"));t.loading("export_report",!1)},exportSim:function(){if(r.repSimilarModules.data.results&&0!==r.repSimilarModules.data.results.length){var e=[].concat(r.repSimilarModules.data.results);o.downloadFile(e,"fastclass_similarModules_"+Date.now()+".json")}else t.showModal(i("work_no_classdata"));t.loading("export_simRep",!1)},exportSimCSV:function(){if(r.repSimilarModules.data.results&&0!==r.repSimilarModules.data.results.length){var e="Similarity;Object 1;Object 2\r\n";r.repSimilarModules.data.results.forEach(function(t){e+=t[0]+";"+t[1][0]+";"+t[1][1]+"\r\n"}),o.downloadFile(e,"fastclass_similarModules_"+Date.now()+".csv",!0)}else t.showModal(i("work_no_classdata"));t.loading("export_simRepCSV",!1)},exportSimReport:function(){0!==r.repSimilarModules.data.results.length?require(["zip"],function(e){var n=new e;n.folder("fastclass").file("report.json",JSON.stringify(r.repSimilarModules)),n.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}}).then(function(e){o.downloadBlob(e,o.createFileName(r.repSimilarModules.meta.reportName)+".fcr"),t.loading("export_sim_report")})}):(t.showModal(i("work_no_model")),t.loading("export_sim_report"))}}}),define("controller/file",["helper/util","view/ui","view/bind","controller/work","controller/store","helper/l10n"],function(e,t,n,r,o,i){var a={readFromInput:function(n,r){if(0!==n.files.length){var l=n.files[0],s=l.name.toLowerCase(),c=s.substring(s.lastIndexOf(".")+1),u=l.name.substring(0,l.name.lastIndexOf(".")),f=new FileReader;if(o.model.meta.modelID||(o.model.meta.modelName=u,o.model.meta.modelID=e.getUUID(),o.model.meta.modelCreated=e.getDateString(),o.model.meta.modelCreator="fastclass Studio",o.model.meta.modelVersion="0.2"),f.addEventListener("load",function(){a.parseUserInput(f.result,c,r)}),f.addEventListener("error",function(){t.showModal(i("file_format_support"))}),"classify"===r&&(o.classifiedFileCurrentType=c,o.classifiedFileSources.push(u)),"report"===r){var d=l.name.substring(0,l.name.lastIndexOf("."));o.repSimilarModules.meta.reportID=e.getUUID(),o.repSimilarModules.meta.reportName=d,t.e("report-name").innerText=d}"json"===c||"xml"===c?f.readAsText(l):"fcm"===c||"fcr"===c||"zip"===c||"pdf"===c&&"classify"===r?f.readAsArrayBuffer(l):t.showModal(i("file_format_no_support"))}else t.showModal(i("file_no_file"))},parseUserInput:function(e,n,r){"classify"===r?(console.log("not available in this demo"),t.hide("classify")):"report"===r?("json"===n?(a.parseJSON(e,r),t.show("import_json_rp")):"xml"===n?a.analyzeXML(e,r):"zip"===n?console.log("not available in this demo"):t.showModal(i("file_format_no_support")),t.hide("import_rp")):("fcr"===n?a.loadFCR(e,"load_fcm"):t.showModal(i("file_format_no_support")),t.hide("import"))},loadFCR:function(e){require(["zip"],function(r){r.loadAsync(e).then(function(e){e.files.hasOwnProperty("fastclass/report.json")?e.folder("fastclass").file("report.json").async("string").then(function(e){o.repSimilarModules=JSON.parse(e),n.printReportAnalysis(o.repSimilarModules)}):t.showModal(i("file_fcm_error"))})})},parseJSON:function(e,n){try{var r=JSON.parse(e);if(Array.isArray(r)&&0!==r.length){r.every(function(e){return"classify"===n?e.hasOwnProperty("xid")&&e.hasOwnProperty("txt"):e.hasOwnProperty("clf")&&e.hasOwnProperty("txt")})?"classify"===n?o.inputDataCl=r:o.inputData=r:t.showModal(i("file_json_format"))}else t.showModal(i("file_json_empty"))}catch(e){t.showModal(i("file_json_valid")+"<br/>"+i("modal_text_details")+": "+e)}},sanitizeXML:function(e,t){return e.replace(/\&[a-z]+?;/g," ").replace(/<\?xml[A-Z].*?\?>/g,"")},analyzeXML:function(e,i){var l=a.sanitizeXML(e),s=new DOMParser;if(xmlDoc=s.parseFromString(l,"application/xml"),"parsererror"===xmlDoc.documentElement.firstChild.localName)throw xmlDoc.documentElement.firstChild.innerHTML;if("classify"===i?o.xmlDocumentsCl.push(xmlDoc):o.xmlDocuments.push(xmlDoc),"1.0"===xmlDoc.documentElement.getAttribute("fastclass"))t.show(["import_xml","disclaimer"]),t.loading("import_xml"),t.content("disclaimer","fastclass XML v1.0"),"classify"===i?(a.parseXML([["node"],"fc-id",[]],i),r.classifyUserInput("xml")):"report"===i?(a.parseXML([["node"],"fc-id",[]],i),r.getSimilarityReport("xml")):(a.parseXML([["node"],"fc-class",[]],i),r.trainModel("xml"));else if("1.0"===xmlDoc.documentElement.getAttribute("data-fastclass"))t.show(["import_xml","disclaimer"]),t.loading("import_xml"),t.content("disclaimer","fastclass HTML v1.0"),"classify"===i?(a.parseXML([["node"],"data-fc-id",[]],i),r.classifyUserInput("xml")):"report"===i?(a.parseXML([["node"],"data-fc-id",[]],i),r.getSimilarityReport("xml")):(a.parseXML([["node"],"data-fc-class",[]],i),r.trainModel("xml"));else{for(var c=xmlDoc.getElementsByTagName("*"),u={},f={},d=c.length-1;d>=0;d--){var p=c.item(d).tagName;u[p]=!0}for(var m in u){var h="*",g=m;if(-1!==m.indexOf(":")){var v=m.split(":")[0];h=xmlDoc.lookupNamespaceURI(v),g=m.split(":")[1]}for(var y=xmlDoc.getElementsByTagNameNS(h,g),b={},_=y.length-1;_>=0;_--)for(var w=y.item(_).attributes,x=w.length-1;x>=0;x--)b[w.item(x).name]=!0;f[m]=b}o.xmlParsingOptions=f,n.printXMLoptions(f,i)}},parseXML:function(e,n){for(var r="classify"===n?o.xmlDocumentsCl:o.xmlDocuments,i=0;i<r.length;i++){for(var a=r[i],l=e[0]||[],s=e[1]||null,c=e[2]||[],u=l.length-1;u>=0;u--){var f=l[u],d="*",p=f;if(-1!==f.indexOf(":")){var m=f.split(":")[0];d=a.lookupNamespaceURI(m),p=f.split(":")[1]}for(var h=a.getElementsByTagNameNS(d,p),g=h.length-1;g>=0;g--){var v=h.item(g);if(v.hasAttribute(s)&&""!==v.getAttribute(s))if("classify"===n)o.inputDataCl.push({xid:v.getAttribute(s),txt:v.textContent.replace(/[\t\r\n ]+/g," ").replace(/\s+/," ")});else if("report"===n){var y="[no heading defined]",b=v.getElementsByTagNameNS(d,"heading");if(b.length>0&&(y=b.item(0).textContent),c.length>0){for(var _=[],w=0;w<c.length;w++)for(var x=v.getElementsByTagName(c[w]),S=x.length-1;S>=0;S--){var M=x.item(S).textContent.replace(/[\t\r\n ]+|\s\s+/g," ");_.push(M)}o.inputDataRp.push({xid:v.getAttribute(s),txt:v.textContent.replace(/[\t\r\n ]+|\s\s+/g," "),sig:_.join(" "),dsc:y})}else o.inputDataRp.push({xid:v.getAttribute(s),txt:v.textContent.replace(/[\t\r\n ]+|\s\s+/g," "),dsc:y})}else if(c.length>0){for(var I=[],k=0;k<c.length;k++)for(var E=v.getElementsByTagName(c[k]),D=E.length-1;D>=0;D--){var A=E.item(D).textContent.replace(/[\t\r\n ]+|\s\s+/g," ");I.push(A)}o.inputData.push({clf:v.getAttribute(s),txt:v.textContent.replace(/[\t\r\n ]+|\s\s+/g," "),sig:I.join(" ")})}else o.inputData.push({clf:v.getAttribute(s),txt:v.textContent.replace(/[\t\r\n ]+|\s\s+/g," ")})}}o.xmlDocuments.splice(i,1),t.hide()}}};return a}),require.config({baseUrl:"scripts",paths:{core:"../core",conf:"../core/configs",d3:"../vendor/d3",mg:"../vendor/metricsgraphics",diff:"../vendor/diff",zip:"../vendor/jszip",selectize:"../vendor/selectize",jquery:"../vendor/jquery",sifter:"../vendor/sifter",microplugin:"../vendor/microplugin",localforage:"../vendor/localforage"}}),require(["config/params","helper/util","helper/l10n","view/ui","view/bind","controller/file","controller/work","controller/store","controller/local"],function(e,t,n,r,o,i,a,l,s){function c(){var e=t.stripURL(window.location.hash);d.includes(e)?r.showPanel(e):r.showModal(n("routing_site_404")+': <b>"'+e+'"</b>',n("modal_title_oops"))}s.init();var u=s.loadSettings();if(null!==u){var f=JSON.parse(u);e.loadConfig(f)}t.browserHasFunctionality()||r.showModal(n("browser_support")+n("browser_alternatives"),n("modal_title_note"));var d=["start","report"];window.addEventListener("hashchange",function(){c()}),""!==window.location.hash&&"#"!==window.location.hash&&c(),document.querySelectorAll(".dropdown-toggle, .no-link").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault()})}),r.click(["modal-ok","modal-x"],r.closeModal),r.click("logo",function(){window.location.hash="",window.location.reload()}),r.bind("report-name","input",function(){l.repSimilarModules.meta.reportName=r.e("report-name").innerText}),r.click("demo",function(){r.hide("prepareTrainingData");var o=e.getParam("demoFiles").fcr[t.getLocale()];fetch(o).then(function(e){e.ok?e.blob().then(function(e){i.loadFCR(e,"demo")}):r.showModal(n("demo_load_fcm"))})}),r.change("userinput_rp",function(){r.hide(["disclaimer_rp"]),r.show("import_rp","inline"),i.readFromInput(r.e("userinput_rp"),"report")}),r.click("import_xml_rp",function(){i.parseXML(o.getXMLoptions("report"),"report"),a.getSimilarityReport("xml")}),r.click("import_json_rp",function(){a.getSimilarityReport("json")}),r.click("import_pdf_rp",function(){a.getSimilarityReport("pdf")}),r.click("load_model",function(){o.showLoadModal(s.getModels()),r.loading("load_model");var e=window.location.hash.slice(1)||"training";r.click("load_localModel",function(){s.loadModel(r.e("localModel").value).then(function(t){l.model=t,o.printTrainingAnalysis(l.model.meta),o.closeModalAndContinue("load-modal",e,["load_localModel"])})}),r.click("load_fileModel",function(){i.readFromInput(r.e("fileModel")),o.closeModalAndContinue("load-modal",e,["load_fileModel"])})}),r.click("clear_data",function(){s.clear().then(function(){r.loading("clear_data")})}),r.click("save_fcm",function(){a.exportMemory()}),r.click("save_locally",function(){s.storeModel(l.model).then(function(){r.loading("save_locally",!1)}).catch(function(e){r.showModal(n("local_save_error")+e)})}),r.click("debug_data",function(){console.dir(l),r.loading("debug_data",!1)}),r.click("export_results",function(){a.exportResults(!0)}),r.click("export_report",function(){a.exportReport()}),r.click("export_simRep",function(){a.exportSim()}),r.click("export_simRepCSV",function(){a.exportSimCSV()}),r.click("save_source",function(){a.exportSource()});var p=e.getParam("similarityThreshold");r.e("similarityThreshold").value=p,r.content("similarityThresholdValue",p),r.bind("similarityThreshold","input",function(t){var n=t.target.value;e.setParam("similarityThreshold",n),r.content("similarityThresholdValue",n)}),r.click("save_report_locally",function(){s.storeReport(l.repSimilarModules).then(function(){r.loading("save_report_locally",!1)}).catch(function(e){r.showModal(n("local_save_error")+e)})}),r.click("export_sim_report",function(){a.exportSimReport()}),r.click("new_report",function(){window.location.reload(),window.location.hash="#report"}),r.click("load_report",function(){o.showLoadModal(s.getReports()),r.loading("load_report"),r.click("load_localModel",function(){s.loadModel(r.e("localModel").value).then(function(e){l.repSimilarModules=e,o.printReportAnalysis(l.repSimilarModules),o.closeModalAndContinue("load-modal","report",["load_localModel"])})}),r.click("load_fileModel",function(){i.readFromInput(r.e("fileModel")),o.closeModalAndContinue("load-modal","report",["load_fileModel"])})}),r.click("change_set",function(){r.loading("change_set"),o.showSettingsModal()}),r.click("reset_set",function(){s.resetSettings(),e.resetConfig(),r.loading("reset_set")}),r.click("export_set",function(){a.exportConfig()})}),define("main",function(){})}();